<!DOCTYPE html>
<html>
<head>
<title>Word Cloud</title>
<meta name='viewport' content-width="device-width" user-scalable='no' initial-scale='1' maximum-scale='1'>

<style>
.touch #cloud span:active, .mouse #cloud span:hover {
  background-color: black;
  color: white;
}

#cloud span {
  padding: 5px;
  border-radius: 10px;
  cursor: pointer;
  -moz-transition-duration: .2s;
  -o-transition-duration: .2s;
  -ms-transition-duration: .2s;
  -webkit-transition-duration: .2s;
  transition-duration: .2s;
  color: blue; /* Font color for the word cloud */
}

#cloud {
  height: auto;
  min-height: 300px;
  display: block;
  border: 1px dashed gray;
  border-radius: 10px;
  margin:auto;
  margin-top: 20px;
  width: 80%;
  padding:15px;
  -webkit-user-select: none;
  user-select: none;
}

h1 {
  width: 100%;
  text-align: center;
}
</style>

<script src="./jquery-2.1.3.js"></script>

<script>
var ENV = {
    device: {
        iOS: null,
        iPhone: null,
        iPad: null,
        android: null,
        mouse: null,
        touch: null
    },
    screen:{
        height:null,
        width:null,
        big: null,
        small: null
    },
    initialize: function(){
        var ua = window.navigator.userAgent.toLowerCase();
        if(ua.indexOf('iphone') >=0 || ua.indexOf('ipad') >=0 ){
            ENV.device.iOS = true;
            if(ua.indexOf('iphone') >=0){
                ENV.device.iPhone = true;
                ENV.device.iPad = false;
            }
            else{
                ENV.device.iPhone = false;
                ENV.device.iPad = true;              
            }

        } 
        else{
            ENV.device.iOS = false; 
            ENV.device.iPhone = false;
            ENV.device.iPad = false;        
        }
        
        
        if(ua.indexOf('android') >=0){
            ENV.device.android = true;          
        }
        else{
            ENV.device.android = false;          
        }
        
        if(ENV.device.iOS || ENV.device.android){
            ENV.device.touch = true;
            ENV.device.mouse = false;
        }
        else{
            ENV.device.touch = false;
            ENV.device.mouse = true;
        }
        
        if(!ENV.device.android){
            ENV.screen.height = $(window).height();
            ENV.screen.width = $(window).width();
        }
        else{
            ENV.screen.height = window.innerHeight;
            ENV.screen.width = window.innerWidth;
        }
        
        if(ENV.screen.width > 1024){
            ENV.screen.big = true;
            ENV.screen.small = false;
        }
        else{
            ENV.screen.big = false;
            ENV.screen.small = true;
        }
        
        var docClassName = "";
        if(ENV.screen.big){
            docClassName = docClassName + " big";
        }
        else{
            docClassName = docClassName + " small";
        }
        if(ENV.device.touch){
            docClassName = docClassName + " touch";
        }
        else{
            docClassName = docClassName + " mouse";
        }
        
        document.getElementsByTagName("html")[0].className = docClassName;
    }
}

function getXMLHTTPRequest() {
    var request;
    try{
        request = new ActiveXObject("Microsoft.XMLHTTP");
    } catch(ex1){
        try{
            request = new ActiveXObject("Msxml2.XMLHTTP");
        } catch(ex2){
            request = null;
        }
    }

    if(!request && typeof XMLHttpRequest != "undefined"){
        request = new XMLHttpRequest();
    }

    return request;
}

function loadData(url, callback) {
    var aXMLHttpRequest = getXMLHTTPRequest();
    var allData;

    if (aXMLHttpRequest) {
        aXMLHttpRequest.open("GET", url, true);
    
        aXMLHttpRequest.onreadystatechange = function (aEvt) {
            if(aXMLHttpRequest.readyState == 4){
                allData = aXMLHttpRequest.responseText;
                callback(allData);
            }
        };
    
        aXMLHttpRequest.send(null);
    } else {
        alert("A problem occurred instantiating the XMLHttpRequest object.");
    }
}

var load = function() {
    ENV.initialize();
    loadData("dream.txt", generateCloud);
}

var allWords = [];
var wordCount = {}

function generateCloud(data) {
    // Split the text into paragraphs
    var paragraphs = data.split('\n\n');

    // Process each paragraph separately
    paragraphs.forEach(function(paragraph) {
        // Get all words in the paragraph
        var words = paragraph.match(/\b\w+\b/g);

        // Count word occurrences
        if (words) {
            words.forEach(function(word) {
                var lowercaseWord = word.toLowerCase();
                if (lowercaseWord.length > 5) {
                    wordCount[lowercaseWord] = wordCount[lowercaseWord] ? wordCount[lowercaseWord] + 1 : 1;
                }
            });
        }
    });

    // Generate word cloud HTML
    var theWords = Object.keys(wordCount);
    var output = "";
    for(var i = 0; i < theWords.length; i++) {
        output += "<span>" + theWords[i] + " </span>"
    }

    // Display word cloud
    document.getElementById('cloud').innerHTML = output;
}
</script>
</head>

<body onload='load()'> <!-- load starts execution after body loads -->
<h1>Word Cloud</h1>
<div id='cloud'></div>
</body>
</html>
