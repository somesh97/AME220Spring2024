<!DOCTYPE html>
<html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">  
    <script>
        var tzSelect = null
        function main(){
            var elems = document.querySelectorAll('.modal');
            var instances = M.Modal.init(elems, {
                onCloseStart: function(){
                    makeClocklist(tzSelect.getSelectedValues());
                }
            });
            elems = document.querySelectorAll('select');
            tzSelect = M.FormSelect.init(elems, {})[0];
            $('#modalTitle').off('click');
        }

        function openDD(){
           // open modal
            var instance = M.Modal.getInstance(document.getElementById('modal1'));
            instance.open();
            $('.select-dropdown.dropdown-trigger').click();
        }

        function makeClocklist(timezones){
            var markup = '';
            for(var i = 0; i < timezones.length; i++){
                var tz = timezones[i].split('_');
                var tzOffset = tz[0];
                var tzName = $(`#timezone option[value="${timezones[i]}"]`).text();
                markup += `<div class='clock-container'>
                                <h5>${tzName}</h5>
                                <iframe src='./clock.html#${tzOffset}'></iframe>
                            </div>`;
            }
            var clockList = document.getElementById('clockList');
            clockList.innerHTML = markup;
        }
    </script>
</head>
<body onload="main()">
    <div id="clocks">
        <div id="clockList"></div>
        <a href='javascript:openDD()' style='position:fixed;right: 10px; bottom:10px ' class="btn-floating btn-large waves-effect waves-light  modal-trigger black"><i class="material-icons">access_time</i></a>
    </div>
    <div id="bigClock"></div>

    <div id="modal1" class="modal">
        <div class="modal-content" style="padding:0">
          <h4 id='modalTitle' onclick="event.preventDefault();" style="pointer-events: none">Manage Timezones</h4>
          <select name="timezone" id="timezone" multiple>
            <!-- Your timezone options -->
          </select>
        </div>
      </div>
</body>
<style>
    #clocks{
        width: 300px;
        height: 100vh;
        overflow: auto;
        background-color: lightblue;
    }
    #bigClock{
        width: calc(100vw - 300px);
        height: 100vh;
        background-color: lightgreen;
        position: fixed;
        right: 0;
        top: 0;
    }
    #modal1{
        width: 80%;
        max-height: 100vh;
        height: 100vh;
        overflow:hidden;
        margin-top: -10%;
        pointer-events: none;
    }
    .select-wrapper{
        pointer-events: auto;
    }
    .select-wrapper ul{
        min-width: 100% !important;
        box-shadow: none !important;
    }
    .clock-container {
        margin-bottom: 20px;
        border: 1px solid #ccc;
        padding: 10px;
    }
    .clock-container h5 {
        margin-top: 0;
    }
    .clock-container iframe {
        width: 100%;
        height: 200px;
        border: none;
    }
</style>
</html>
